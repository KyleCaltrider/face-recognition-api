(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{15:function(e,t,a){},16:function(e,t,a){},17:function(e,t,a){"use strict";a.r(t);var n=a(0),o=a.n(n),l=a(3),r=a.n(l),s=(a(15),a(4)),i=a(5),c=a(8),u=a(6),d=a(7),p=a(1),h=(a(16),function(e){return o.a.createElement("form",{id:"registration",className:"options-bar"},o.a.createElement("label",null,"New User:",o.a.createElement("input",{type:"text",name:"user",value:e.user,onChange:e.userChange,required:!0})),o.a.createElement("button",{onClick:e.click},"Submit"))}),m=function(e){return o.a.createElement("div",{id:"bulk",className:""},o.a.createElement("label",null,"Upload Users:",o.a.createElement("input",{type:"file",name:"bulk",accept:"image/*",multiple:!0,onChange:e.upload})),o.a.createElement("label",null,"Compare:",o.a.createElement("input",{type:"file",name:"image",accept:"image/*",onChange:function(t){return e.compare(t.target.files[0])}})))},g=function(e){return o.a.createElement("div",{id:"description"},o.a.createElement("p",{id:"welcome"},"Welcome to my facial recognition demo app."),o.a.createElement("ul",null,o.a.createElement("strong",null,"Highlights:"),o.a.createElement("li",null,"Python Backend built on Flask"),o.a.createElement("li",null,"MongoDB Storage"),o.a.createElement("li",null,"ReactJS Frontend"),o.a.createElement("li",null,"Identifies users in a photo"),o.a.createElement("li",null,"Image upload options for adding known users and comparing users"),o.a.createElement("li",null,"Expandable but session based user collection")),o.a.createElement("p",{id:"usage-info",className:"text-small"},'This app needs media device access (camera) and JavaScript enabled to run.\nPress the Photo Button to snap a pic and compare it to known users. Add a new known face by either filling in New User > Submit (snaps a new pic), or by using the Upload Users option.\nTo upload a new user(s) image, name the photo(s) after the user in the picture (1 user per photo on this step, ex: "Pickle Rick.jpg").\nUse the Compare upload option to search an uploaded image for known users.\nIf the app knows who\'s in the photo it will display their user names above.'),o.a.createElement("p",{id:"disclaimer",className:"text-small"},"** This app needs to set a cookie to keep an open user collection of facial recognition data.\nOnly the active browser with unique cookie has access to the users in the collection. The button bellow can be used to erase the current session\ncollection from the database. As a precaution, all collections in the demo database are removed nightly."))},b=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(c.a)(this,Object(u.a)(t).call(this,e))).state={photoURL:"",user:void 0},a.handleVideo=a.handleVideo.bind(Object(p.a)(Object(p.a)(a))),a.handleTakePhoto=a.handleTakePhoto.bind(Object(p.a)(Object(p.a)(a))),a.checkIdentity=a.checkIdentity.bind(Object(p.a)(Object(p.a)(a))),a.registerUser=a.registerUser.bind(Object(p.a)(Object(p.a)(a))),a.handleUserChange=a.handleUserChange.bind(Object(p.a)(Object(p.a)(a))),a.handleDeleteAllUsers=a.handleDeleteAllUsers.bind(Object(p.a)(Object(p.a)(a))),a.handleBulkUpload=a.handleBulkUpload.bind(Object(p.a)(Object(p.a)(a))),a}return Object(d.a)(t,e),Object(i.a)(t,[{key:"componentDidMount",value:function(){this.handleVideo()}},{key:"handleBulkUpload",value:function(e){e.preventDefault(),console.log("POST to /register");var t=e.target.name,a=e.target.files;console.log("Name:",t,"Files:",a);var n=new FormData;for(var o in a)n.append(t,a[o]);var l=new XMLHttpRequest;l.open("POST","/register"),l.onload=function(){alert(l.responseText),console.log("Response:",l.responseText)},l.send(n)}},{key:"handleUserChange",value:function(e){this.setState({user:e.target.value})}},{key:"handleVideo",value:function(){console.log("Starting Video Stream From Media Device");navigator.mediaDevices.getUserMedia({video:!0}).then(function(e){var t=document.getElementById("camera-display");window.stream=e,t.srcObject=e;var a=e.getVideoTracks();console.log("Track 0: ",a[0]);var n=a[0].getCapabilities();console.log("Capabilities: ",n)}).catch(function(e){alert("Can't Get Video!"),console.log("getUserMedia Error: ",e)})}},{key:"handleTakePhoto",value:function(e){console.log("Taking Photo From Media Device");navigator.mediaDevices.getUserMedia({video:!0}).then(function(t){var a=t.getVideoTracks()[0];new ImageCapture(a).takePhoto().then(function(t){e(t)})}).catch(function(e){alert("Can't Take Photo!"),console.log("getUserMedia Error:",e)})}},{key:"checkIdentity",value:function(e){var t=this;console.log("POST to /identify");var a=new FormData;a.append("image",e,"user-image.jpeg");var n=new XMLHttpRequest;n.open("POST","/identify"),n.onload=function(){var a=JSON.parse(n.response);if(t.state.photoURL&&URL.revokeObjectURL(t.state.photoURL),t.setState({photoURL:URL.createObjectURL(e)}),a.length){var o=a.map(function(e){return e.user});console.log("Response:",a),console.log("New Users:",o),t.setState({user:o,showRegistration:!1})}else t.setState({user:"Unknown User(s)"}),console.log("Response",a)},n.send(a)}},{key:"registerUser",value:function(e){console.log("POST to /register");var t=new FormData;t.append("user",this.state.user),t.append("image",e,"user-image.jpeg");var a=new XMLHttpRequest;a.open("POST","/register"),a.onload=function(){console.log("Response:",a.responseText),alert(a.responseText)},a.send(t)}},{key:"handleDeleteAllUsers",value:function(){var e=new XMLHttpRequest;e.open("GET","/delete"),e.onload=function(){console.log("Response:",e.responseText),alert(e.responseText)},e.send()}},{key:"render",value:function(){var e=this;return o.a.createElement("div",{className:"App"},o.a.createElement("div",{id:"photo-container"},o.a.createElement("h3",{id:"users"},"Users In This Photo:",o.a.createElement("br",null),this.state.user),o.a.createElement("img",{id:"photo",src:this.state.photoURL||"https://via.placeholder.com/500x400?text=Take+A+Picture!"})),o.a.createElement(h,{user:this.state.user,userChange:this.handleUserChange,click:function(t){t.preventDefault(),e.handleTakePhoto(e.registerUser)}}),o.a.createElement(m,{upload:this.handleBulkUpload,compare:this.checkIdentity}),o.a.createElement("button",{className:"button",onClick:function(){return e.handleTakePhoto(e.checkIdentity)}},o.a.createElement("i",{className:"fas fa-camera"})),o.a.createElement("video",{id:"camera-display",autoPlay:!0,playsInline:!0},"Your browser does not support the media tag"),o.a.createElement("h1",{id:"title",className:"title"},"Facial Recognition API Demo"),o.a.createElement("h2",{id:"subtitle",className:"title"},"Powered by Python & ReactJS"),o.a.createElement(g,null),o.a.createElement("button",{id:"delete-db",onClick:this.handleDeleteAllUsers},o.a.createElement("strong",null,"Erase User Facial Recognition Data")))}}]),t}(n.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));r.a.render(o.a.createElement(b,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})},9:function(e,t,a){e.exports=a(17)}},[[9,1,2]]]);
//# sourceMappingURL=main.5b2ae259.chunk.js.map